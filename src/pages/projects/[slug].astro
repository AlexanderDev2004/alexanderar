---
import { getCollection } from "astro:content";

export async function getStaticPaths() {
  const allProjects = [
    ...(await getCollection("games")),
    ...(await getCollection("website")),
  ];

  return allProjects.map((project) => ({
    params: { slug: project.id },
    props: { project },
  }));
}

const { project } = Astro.props;

if (!project) {
  throw new Error("Project not found");
}

const { title, description, demo, source, stack } = project.data;

---

<html lang="en">
  <head>
    <title>{title} - Project Details</title>
  </head>
  <body class="bg-gray-900 text-white">
    <div class="container mx-auto px-4 py-12">
      <h1 class="text-4xl font-bold text-red-500">{title}</h1>
      <p class="text-gray-400 mt-2">{description}</p>

      <!-- Tech Stack -->
      {stack && (
        <div class="mt-4">
          <strong class="text-white">Tech Stack:</strong>
          <ul class="list-disc ml-5">
            {stack.map((tech: { name: string; link: string }) => (
              <li>
                <a href={tech.link} class="text-blue-400 hover:text-blue-300">
                  {tech.name}
                </a>
              </li>
            ))}
          </ul>
        </div>
      )}

      <!-- Demo & Source Code -->
      <div class="mt-6 flex space-x-4">
        {demo && (
          <a
            href={demo}
            class="inline-block px-4 py-2 bg-green-500 hover:bg-green-600 rounded text-white"
            target="_blank"
          >
            Live Demo
          </a>
        )}
        {source && (
          <a
            href={source}
            class="inline-block px-4 py-2 bg-blue-500 hover:bg-blue-600 rounded text-white"
            target="_blank"
          >
            Source Code
          </a>
        )}
      </div>

      <!-- Isi MDX -->
      <div class="mt-8 prose prose-invert">
        {project.body}
      </div>
    </div>
  </body>
</html>
